{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useSharedState}from\"../../SharedContext.jsx\";import{v4 as uuidv4}from\"uuid\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function ButtonShareMarkers(){const{sharedMarkers,setSharedMarkers}=useSharedState();const{isSharedLink,setIsSharedLink}=useSharedState();// eslint-disable-next-line no-unused-vars\nconst{markersLoaded,setMarkersLoaded}=useSharedState();const{isMobile}=useSharedState();const{mapArray}=useSharedState();// State for managing modal visibility and the shareable link\nconst[showModal,setShowModal]=useState(false);const[shareableLink,setShareableLink]=useState(\"\");const sendMarkerData=async()=>{const uuidMarkers=uuidv4();const updatedUuidMarkers=sharedMarkers.map(marker=>({...marker,groupId:uuidMarkers}));try{const response=await fetch(\"/MarkerInformation\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(updatedUuidMarkers)});if(!response.ok){throw new Error(\"HTTP error! status: \".concat(response.status));}// Update the shareable link state and show the modal\nconst link=\"/shared-markers?groupId=\".concat(uuidMarkers);setShareableLink(link);setShowModal(true);// Show the modal with the link\n}catch(error){console.error(\"Error sending marker data:\",error);}};const fetchGroupMarkers=async groupId=>{const url=\"/shared-markers?groupId=\".concat(groupId);try{const response=await fetch(url);if(!response.ok){throw new Error(\"HTTP error! status: \".concat(response.status));}const data=await response.json();setSharedMarkers(data);setIsSharedLink(true);setMarkersLoaded(true);}catch(error){console.error(\"Error fetching group markers:\",error);}};useEffect(()=>{const queryParams=new URLSearchParams(window.location.search);const groupId=queryParams.get(\"groupId\");if(groupId){fetchGroupMarkers(groupId);}else{setMarkersLoaded(true);}},[]);// Function to copy the shareable link to clipboard\nconst copyToClipboard=()=>{navigator.clipboard.writeText(shareableLink).then(()=>{// Optional: Display a message or change button text/state to indicate the link was copied\n},err=>{console.error(\"Could not copy text: \",err);});};// Modal\nconst ShareModal=()=>/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-[1007] \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-4 rounded-lg shadow-lg flex flex-col items-center\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Here's your shareable link:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",readOnly:true,value:shareableLink,className:\"text-center p-2 border border-gray-300 rounded mt-2\",onClick:e=>e.target.select()}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 mt-3\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"px-4 py-2 my-auto  bg-blue-500 text-white rounded hover:bg-blue-700\",onClick:copyToClipboard,children:\"Copy\"}),/*#__PURE__*/_jsx(\"button\",{className:\"px-4 py-2 my-auto  bg-blue-500 text-white rounded hover:bg-blue-700\",onClick:()=>setShowModal(false),children:\"Close\"})]})]})});return/*#__PURE__*/_jsxs(_Fragment,{children:[showModal&&/*#__PURE__*/_jsx(ShareModal,{}),isMobile?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"button\",{onClick:sendMarkerData,className:\"send-button \".concat(mapArray.length===0?\"hidden\":\"visible\",\" text-xs px-3 text-center my-auto py-2 rounded-full share-button-mobile\"),children:\"Share tags!\"})}):/*#__PURE__*/_jsx(_Fragment,{children:!isSharedLink&&/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center\",children:/*#__PURE__*/_jsx(\"button\",{className:\"share-button-mobile body-font  text-xl backdrop-blur-xl flex px-5 py-4 rounded-full fixed mb-10 p4 bottom-2 mx-auto hover:bg-gray-400 \",onClick:sendMarkerData,children:\"Share tags!\"})})})]});}export default ButtonShareMarkers;","map":{"version":3,"names":["React","useState","useEffect","useSharedState","v4","uuidv4","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ButtonShareMarkers","sharedMarkers","setSharedMarkers","isSharedLink","setIsSharedLink","markersLoaded","setMarkersLoaded","isMobile","mapArray","showModal","setShowModal","shareableLink","setShareableLink","sendMarkerData","uuidMarkers","updatedUuidMarkers","map","marker","groupId","response","fetch","method","headers","body","JSON","stringify","ok","Error","concat","status","link","error","console","fetchGroupMarkers","url","data","json","queryParams","URLSearchParams","window","location","search","get","copyToClipboard","navigator","clipboard","writeText","then","err","ShareModal","className","children","type","readOnly","value","onClick","e","target","select","length"],"sources":["/home/jonas/web-projects/trash-tagger/frontend/src/components/buttons/ButtonShareMarkers.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useSharedState } from \"../../SharedContext.jsx\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nfunction ButtonShareMarkers() {\n  const { sharedMarkers, setSharedMarkers } = useSharedState();\n  const { isSharedLink, setIsSharedLink } = useSharedState();\n  // eslint-disable-next-line no-unused-vars\n  const { markersLoaded, setMarkersLoaded } = useSharedState();\n  const { isMobile } = useSharedState();\n  const { mapArray } = useSharedState();\n\n  // State for managing modal visibility and the shareable link\n  const [showModal, setShowModal] = useState(false);\n  const [shareableLink, setShareableLink] = useState(\"\");\n\n  const sendMarkerData = async () => {\n    const uuidMarkers = uuidv4();\n    const updatedUuidMarkers = sharedMarkers.map((marker) => ({\n      ...marker,\n      groupId: uuidMarkers,\n    }));\n\n    try {\n      const response = await fetch(\"/MarkerInformation\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(updatedUuidMarkers),\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n\n      // Update the shareable link state and show the modal\n      const link = `/shared-markers?groupId=${uuidMarkers}`;\n      setShareableLink(link);\n\n      setShowModal(true); // Show the modal with the link\n    } catch (error) {\n      console.error(\"Error sending marker data:\", error);\n    }\n  };\n\n  const fetchGroupMarkers = async (groupId) => {\n    const url = `/shared-markers?groupId=${groupId}`;\n    try {\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      const data = await response.json();\n      setSharedMarkers(data);\n      setIsSharedLink(true);\n      setMarkersLoaded(true);\n    } catch (error) {\n      console.error(\"Error fetching group markers:\", error);\n    }\n  };\n\n  useEffect(() => {\n    const queryParams = new URLSearchParams(window.location.search);\n    const groupId = queryParams.get(\"groupId\");\n\n    if (groupId) {\n      fetchGroupMarkers(groupId);\n    } else {\n      setMarkersLoaded(true);\n    }\n  }, []);\n\n  // Function to copy the shareable link to clipboard\n  const copyToClipboard = () => {\n    navigator.clipboard.writeText(shareableLink).then(\n      () => {\n        // Optional: Display a message or change button text/state to indicate the link was copied\n      },\n      (err) => {\n        console.error(\"Could not copy text: \", err);\n      }\n    );\n  };\n\n  // Modal\n  const ShareModal = () => (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-[1007] \">\n      <div className=\"bg-white p-4 rounded-lg shadow-lg flex flex-col items-center\">\n        <p>Here's your shareable link:</p>\n        <input\n          type=\"text\"\n          readOnly\n          value={shareableLink}\n          className=\"text-center p-2 border border-gray-300 rounded mt-2\"\n          onClick={(e) => e.target.select()}\n        />\n        <div className=\"flex gap-3 mt-3\">\n          <button\n            className=\"px-4 py-2 my-auto  bg-blue-500 text-white rounded hover:bg-blue-700\"\n            onClick={copyToClipboard}\n          >\n            Copy\n          </button>\n          <button\n            className=\"px-4 py-2 my-auto  bg-blue-500 text-white rounded hover:bg-blue-700\"\n            onClick={() => setShowModal(false)}\n          >\n            Close\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n\n  return (\n    <>\n      {showModal && <ShareModal />}\n      {isMobile ? (\n        <>\n          <button\n            onClick={sendMarkerData}\n            className={`send-button ${\n              mapArray.length === 0 ? \"hidden\" : \"visible\"\n            } text-xs px-3 text-center my-auto py-2 rounded-full share-button-mobile`}\n          >\n            Share tags!\n          </button>\n        </>\n      ) : (\n        <>\n          {!isSharedLink && (\n            <div className=\"flex justify-center\">\n              <button\n                className=\"share-button-mobile body-font  text-xl backdrop-blur-xl flex px-5 py-4\n                 rounded-full fixed mb-10 p4 bottom-2 mx-auto hover:bg-gray-400 \"\n                onClick={sendMarkerData}\n              >\n                Share tags!\n              </button>\n            </div>\n          )}\n        </>\n      )}\n    </>\n  );\n}\n\nexport default ButtonShareMarkers;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}